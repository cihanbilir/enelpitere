package morphology;

import zemberek.core.turkish.PrimaryPos;
import zemberek.core.turkish.RootAttribute;
import zemberek.core.turkish.SecondaryPos;
import zemberek.morphology.analysis.WordAnalysis;
import zemberek.morphology.analysis.tr.TurkishMorphology;
import zemberek.morphology.lexicon.DictionaryItem;

import java.io.IOException;
import java.util.List;


public class AddNewDictionaryItem {

    TurkishMorphology morphology;

    public AddNewDictionaryItem(TurkishMorphology morphology) {
        this.morphology = morphology;
    }

    void test(String input, DictionaryItem newItem) throws IOException {

        List<WordAnalysis> before = morphology.analyze(input);
        System.out.println("Parses for " + input + " before adding " + newItem);
        printResults(before);

        morphology.invalidateAllCache();

        morphology.getGraph().addDictionaryItem(newItem);

        List<WordAnalysis> after = morphology.analyze(input);
        System.out.println("Parses for " + input + " after adding " + newItem);
        printResults(after);
    }

    private void printResults(List<WordAnalysis> results) {
        int i = 1;
        for (WordAnalysis result : results) {
            String str = result.formatLong();
            if (result.dictionaryItem.attributes.contains(RootAttribute.Runtime)) {
                str = str + " (Generated by UnidentifiedTokenParser)";
            }
            System.out.println(i + " - " + str);
            i++;
        }
    }

    public static void main(String[] args) throws IOException {

        TurkishMorphology morphology = TurkishMorphology.createWithDefaults();
        AddNewDictionaryItem app = new AddNewDictionaryItem(morphology);

        System.out.println("Proper Noun Test - 1 :");
        app.test("Meydan'a",
                new DictionaryItem("Meydan", "meydan", "meydan", PrimaryPos.Noun, SecondaryPos.ProperNoun));
        System.out.println();

        System.out.println("Proper Noun Test - 2 :");
        app.test("Meeeydan'a",
                new DictionaryItem("Meeeydan", "meeeydan", "meeeydan", PrimaryPos.Noun, SecondaryPos.ProperNoun));
        System.out.println();

        System.out.println("Verb Test : ");
        app.test("tweetleyeyazdÄ±m",
                new DictionaryItem("tweetlemek", "tweetle", "tivitle", PrimaryPos.Verb, SecondaryPos.None));

    }
}
